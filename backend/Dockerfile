# (по умолчанию нумеруются с 0) – установка образа и задание переменной
FROM maven:3.6.3-jdk-11 as builder
# контекст, в котором будет запускаться контейнер
WORKDIR /source
# копирование всех файлов в source
COPY . /source
#  сборка приложения с помощью maven при создании контейнера
RUN mvn clean package

# установка образа
FROM maven:3.6.3-jdk-11
# контекст, в котором будет запускаться контейнер
WORKDIR /app
# копирование результатов сборки из builder, а точнее файла приложения, в директорию app
COPY --from=builder /source/target/demo-0.0.1-SNAPSHOT.jar /app
# говорит докеру, что данный контейнер использует порт 7000
EXPOSE 7000
# после запуска контейнера запустить приложение
CMD java -jar demo-0.0.1-SNAPSHOT.jar

# Что означает повторение директивы FROM?
# Многоэтапная сборка контейнера, позволяющая продолжить сборку после компиляции.